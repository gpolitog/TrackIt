webpackJsonp([9],{116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),s=n(36),c=n(120),a=n(134),r=n(171),o=n.n(r),u=n(296);n.n(u);n(117),i.a.config.productionTip=!1;var v={};-1===window.location.host.indexOf("localhost:9004")&&-1===window.location.host.indexOf("localhost:9005")&&-1===window.location.host.indexOf("localhost:7004")||(v={httpConfig:{server:"https://localhost",port:9005},mqttConfig:{server:"ws://localhost:9016"}}),i.a.use(o.a,v),i.a.use(s.G),s.a.set("#333333"),n(294),s.G.start(function(){new i.a({el:"#q-app",router:c.a,store:a.a,render:function(e){return e(n(298))}})})},117:function(e,t){},120:function(e,t,n){"use strict";function i(e){return function(){return n(122)("./"+e+".vue")}}var s=n(8),c=n(121);s.a.use(c.a),t.a=new c.a({routes:[{path:"/",component:i("Index")},{path:"/login",component:i("Login")},{path:"/login/:token",component:i("Login")},{path:"*",component:i("Error404")}]})},122:function(e,t,n){function i(e){var t=s[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var s={"./Device.vue":[305,7],"./DeviceList.vue":[308,3],"./Error404.vue":[311,6],"./Index.vue":[312,0],"./Login.vue":[310,4],"./Map.vue":[309,1],"./PostMessageModal.vue":[307,5],"./Queue.vue":[306,2]};i.keys=function(){return Object.keys(s)},i.id=122,e.exports=i},134:function(e,t,n){"use strict";var i=n(115),s=n(8),c=n(135),a=n(160),r=n(161),o=n(162);s.a.use(i.b);var u={token:"",devices:[],activeDevicesID:[],hasDevicesInit:!1,offline:!1};t.a=new i.b.Store({state:u,actions:c.a,mutations:a.a,getters:r.a,modules:o.a})},135:function(e,t,n){"use strict";function i(e){var t=(e.state,e.commit);o.a.connector.http.get("/statics/icons/favicon-16x16.png?_="+(new Date).getTime()).then(function(e){200===e.status&&t("setOfflineFlag",!1)}).catch(function(e){console.log(e)})}var s=n(46),c=n.n(s),a=n(47),r=n.n(a),o=n(8),u=n(36),v=function(){var e=r()(c.a.mark(function e(t){var n,i,s,a=t.state,r=t.commit;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r("reqStart"),e.prev=1,!a.token){e.next=10;break}return e.next=5,o.a.connector.getDevices("all",{fields:"id,name,ident,phone,telemetry,messages_ttl"});case 5:return n=e.sent,i=n.data,r("reqSuccessful",{type:"devices",payload:i}),a.hasDevicesInit||(r("setDevicesInit"),(s=u.e.get.item("TrackIt Active Devices"))&&s.length&&s.forEach(function(e){i.result.filter(function(t){return t.id===e}).length&&r("setActiveDevice",e)})),e.abrupt("return",i.result);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r("reqFailed",e.t0);case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=r()(c.a.mark(function e(t){var n=(t.state,t.commit);return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.connector.subscribeLogs("registry","devices/+","#",function(e){n("updateDevices",e)});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=r()(c.a.mark(function e(t,n){var i,s,a=(t.state,t.commit),r=n.data,u=n.id;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("reqStart"),e.prev=1,e.next=4,o.a.connector.postDevicesMessages(u,r);case 4:i=e.sent,s=i.data,a("reqSuccessful",{type:"postMessage",payload:s}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a("reqFailed",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=r()(c.a.mark(function e(t){t.state,t.commit;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.connector.unsubscribeLogs("registry","devices/+","#");case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();t.a={getDevices:v,postMessage:p,checkConnection:i,subscribeDevices:f,unsubscribeDevices:l}},160:function(e,t,n){"use strict";function i(e){}function s(e,t){var n=t.type,i=t.payload,s=i.result;switch(n){case"postMessage":g.F.create.positive({html:"Post message to devices with IDs "+s+" success",icon:"alarm_add",timeout:2500,bgColor:"white"});break;default:D()(e[n])!==D()(s)&&k.a.set(e,n,s)}}function c(e,t){var n=JSON.parse(t);switch(n.event_code){case 1:e.devices.push(n.item_data);break;case 2:var i=n.item_data;e.devices.some(function(t,n){return t.id===i.id&&(e.devices[n]=h()(e.devices[n],i),!0)});break;case 3:var s=n.item_data;e.devices.some(function(t,n){return t.id===s.id&&(e.devices.splice(n,1),!0)})}}function a(e,t){switch(t.response.status){case 0:r(e,!0),l(e),k.a.set(e,"token","");break;case 401:u(e)}}function r(e,t){k.a.set(e,"offline",t)}function o(e,t){var n=t.replace("FlespiToken ","");t&&n.match(/^[a-z0-9]+$/i)?(k.a.connector.token="FlespiToken "+n,g.e.set("X-Flespi-Token",n)):(n="",k.a.connector.token="",u(e)),k.a.set(e,"token",n)}function u(e){var t=g.b.get("X-Flespi-Token"),n=g.e.get.item("X-Flespi-Token");t&&n&&t===n&&g.b.remove("X-Flespi-Token"),g.e.remove("X-Flespi-Token"),k.a.connector.token="",k.a.set(e,"token","")}function v(e,t){e.devices.filter(function(e){return e.id===t})[0].messages_ttl&&(e.activeDevicesID.push(t),g.e.set("TrackIt Active Devices",e.activeDevicesID))}function f(e,t){e.activeDevicesID=e.activeDevicesID.filter(function(e){return e!==t}),g.e.set("TrackIt Active Devices",e.activeDevicesID)}function p(e){e.hasDevicesInit=!0}function l(e){e.hasDevicesInit=!1,k.a.set(e,"devices",[]),k.a.set(e,"activeDevicesID",[])}var d=n(114),h=n.n(d),m=n(61),D=n.n(m),g=n(36),k=n(8);t.a={reqStart:i,reqSuccessful:s,reqFailed:a,setToken:o,clearToken:u,setActiveDevice:v,unsetActiveDevice:f,setDevicesInit:p,unsetDevicesInit:l,setOfflineFlag:r,updateDevices:c}},161:function(e,t,n){"use strict";t.a={}},162:function(e,t,n){"use strict";var i=n(163);t.a={messages:i.a}},163:function(e,t,n){"use strict";var i=n(164),s=n(165),c={entities:{},timestamp:0,activeDevicesID:[]};t.a={namespaced:!0,state:c,actions:i.a,mutations:s.a}},164:function(e,t,n){"use strict";function i(e,t){var n=this,i=e.state,s=e.commit,a=e.rootState;s("reqStart");var o={count:10,reverse:!0,filter:"position.latitude,position.longitude",to:i.timestamp||0};t.forEach(function(e){i.entities[e]||v.a.set(i.entities,e,[])});try{a.token&&t.forEach(function(){var e=u()(c.a.mark(function e(t){var i,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.connector.getDevicesMessages(t,{data:r()(o)});case 2:i=e.sent,a=i.data,s("reqSuccessful",a);case 5:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}())}catch(e){s("reqFailed",e,{root:!0})}}var s=n(46),c=n.n(s),a=n(61),r=n.n(a),o=n(47),u=n.n(o),v=n(8);t.a={getHistoryByDeviceID:i}},165:function(e,t,n){"use strict";function i(e){}function s(e,t){var n=t.result;e.activeDevicesID.forEach(function(t){var i=n.filter(function(e){return e.device_id===t});if(!i.length)return e.entities[t]||d.a.set(e.entities,t,[]),!1;var s=e.entities[t]||[];d.a.set(e.entities,t,[].concat(l()(i),l()(s)).slice(0,10))}),d.a.set(e,"timestamp",parseInt(e.activeDevicesID.reduce(function(t,n){return e.entities[n].length&&e.entities[n][0].timestamp>t?e.entities[n][0].timestamp:t},0)))}function c(e){var t=this;e.activeDevicesID.length&&(e.activeDevicesID.forEach(function(){var e=f()(u.a.mark(function e(n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.connector.unsubscribeMessagesDevices(n);case 2:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()),d.a.set(e,"entities",{}),d.a.set(e,"activeDevicesID",[]),d.a.set(e,"timestamp",0))}function a(e,t){d.a.connector.unsubscribeMessagesDevices(t),d.a.delete(e.entities,t)}function r(e,t){var n=this;t.filter(function(t){return!e.activeDevicesID.includes(t)}).forEach(function(){var t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.connector.subscribeMessagesDevices(i,function(t){s(e,{result:[JSON.parse(t)]})});case 2:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}()),d.a.set(e,"activeDevicesID",t)}var o=n(46),u=n.n(o),v=n(47),f=n.n(v),p=n(166),l=n.n(p),d=n(8);t.a={reqStart:i,reqSuccessful:s,clear:c,clearByID:a,setActiveDevicesID:r}},262:function(e,t){},284:function(e,t){},285:function(e,t){},295:function(e,t){},297:function(e,t){},298:function(e,t,n){function i(e){n(299)}var s=n(113)(n(300),n(301),i,null,null);e.exports=s.exports},299:function(e,t){},300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},301:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},staticRenderFns:[]}}},[116]);