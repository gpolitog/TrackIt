webpackJsonp([9],{117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),s=n(59),c=n(121),a=n(159),r=n(172),o=n.n(r),u=n(299);n.n(u);n(118),i.a.config.productionTip=!1;var v={socketConfig:{clientId:"trackit-"+Math.random().toString(16).substr(2,8)}};-1===window.location.host.indexOf("localhost:9004")&&-1===window.location.host.indexOf("localhost:9005")&&-1===window.location.host.indexOf("localhost:7004")||(v={httpConfig:{server:"https://localhost",port:9005},socketConfig:{server:"wss://localhost:9017",clientId:"trackit-dev-"+Math.random().toString(16).substr(2,8)}}),i.a.use(o.a,v),i.a.use(s.H),s.a.set("#333333"),n(297),s.H.start(function(){new i.a({el:"#q-app",router:c.a,store:a.a,render:function(e){return e(n(301))}})})},118:function(e,t){},121:function(e,t,n){"use strict";function i(e){return function(){return n(123)("./"+e+".vue")}}var s=n(8),c=n(122);s.a.use(c.a),t.a=new c.a({routes:[{path:"/",component:i("Index")},{path:"/login",component:i("Login")},{path:"/login/:token",component:i("Login")},{path:"*",component:i("Error404")}]})},123:function(e,t,n){function i(e){var t=s[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var s={"./Device.vue":[308,7],"./DeviceList.vue":[311,3],"./Error404.vue":[314,6],"./Index.vue":[315,0],"./Login.vue":[313,4],"./Map.vue":[312,1],"./PostMessageModal.vue":[310,5],"./Queue.vue":[309,2]};i.keys=function(){return Object.keys(s)},i.id=123,e.exports=i},159:function(e,t,n){"use strict";var i=n(116),s=n(8),c=n(160),a=n(161),r=n(162),o=n(163);s.a.use(i.b);var u={token:"",devices:[],activeDevicesID:[],hasDevicesInit:!1,offline:!1};t.a=new i.b.Store({state:u,actions:c.a,mutations:a.a,getters:r.a,modules:o.a})},160:function(e,t,n){"use strict";function i(e){var t=(e.state,e.commit);o.a.connector.http.get("/statics/icons/favicon-16x16.png?_="+(new Date).getTime()).then(function(e){200===e.status&&t("setOfflineFlag",!1)}).catch(function(e){console.log(e)})}var s=n(38),c=n.n(s),a=n(39),r=n.n(a),o=n(8),u=function(){var e=r()(c.a.mark(function e(t){var n,i=this,s=t.state,a=t.commit;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a("reqStart"),e.prev=1,!s.token){e.next=7;break}return e.next=5,o.a.connector.poolDevices(function(e){a("setDevices",e)},function(e,t){a("updateDevices",{type:e,device:t})});case 5:return n=e.sent,e.abrupt("return",r()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.connector.poolDevicesStop(n);case 2:case"end":return e.stop()}},e,i)})));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a("reqFailed",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=r()(c.a.mark(function e(t,n){var i,s,a=(t.state,t.commit),r=n.data,u=n.id;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a("reqStart"),e.prev=1,e.next=4,o.a.connector.registry.postDevicesMessages(u,r);case 4:i=e.sent,s=i.data,a("reqSuccessful",{type:"postMessage",payload:s}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a("reqFailed",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,n){return e.apply(this,arguments)}}();t.a={poolDevices:u,postMessage:v,checkConnection:i}},161:function(e,t,n){"use strict";function i(e){}function s(e,t){var n=t.type,i=t.payload,s=i.result;switch(n){case"postMessage":k.G.create.positive({html:"Post message to devices with IDs "+s+" success",icon:"alarm_add",timeout:2500,bgColor:"white"});break;default:g()(e[n])!==g()(s)&&I.a.set(e,n,s)}}function c(e,t){if(g()(e.devices)!==g()(t.data.result)&&I.a.set(e,"devices",t.data.result),!e.hasDevicesInit){l(e);var n=k.e.get.item("TrackIt Active Devices");n&&n.length&&n.forEach(function(n){t.data.result.filter(function(e){return e.id===n}).length&&f(e,n)})}}function a(e,t){switch(t.type){case"created":e.devices.push(t.device);break;case"updated":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices[i]=D()(e.devices[i],t.device),!0)});break;case"deleted":e.devices.some(function(n,i){return n.id===t.device.id&&(e.devices.splice(i,1),!0)})}}function r(e,t){switch(t.response.status){case 0:o(e,!0),d(e),I.a.set(e,"token","");break;case 401:v(e)}}function o(e,t){I.a.set(e,"offline",t)}function u(e,t){var n=t.replace("FlespiToken ","");t&&n.match(/^[a-z0-9]+$/i)?(I.a.connector.token="FlespiToken "+n,k.e.set("X-Flespi-Token",n)):(n="",I.a.connector.token="",v(e)),I.a.set(e,"token",n)}function v(e){var t=k.b.get("X-Flespi-Token"),n=k.e.get.item("X-Flespi-Token");t&&n&&t===n&&k.b.remove("X-Flespi-Token"),k.e.remove("X-Flespi-Token"),I.a.connector.token="",I.a.set(e,"token","")}function f(e,t){e.devices.filter(function(e){return e.id===t})[0].messages_ttl&&(e.activeDevicesID.push(t),k.e.set("TrackIt Active Devices",e.activeDevicesID))}function p(e,t){e.activeDevicesID=e.activeDevicesID.filter(function(e){return e!==t}),k.e.set("TrackIt Active Devices",e.activeDevicesID)}function l(e){e.hasDevicesInit=!0}function d(e){e.hasDevicesInit=!1,I.a.set(e,"devices",[]),I.a.set(e,"activeDevicesID",[])}var h=n(115),D=n.n(h),m=n(61),g=n.n(m),k=n(59),I=n(8);t.a={reqStart:i,reqSuccessful:s,reqFailed:r,setToken:u,clearToken:v,setActiveDevice:f,unsetActiveDevice:p,setDevicesInit:l,unsetDevicesInit:d,setOfflineFlag:o,updateDevices:a,setDevices:c}},162:function(e,t,n){"use strict";t.a={}},163:function(e,t,n){"use strict";var i=n(164);t.a={messages:i.a}},164:function(e,t,n){"use strict";var i=n(165),s=n(166),c={entities:{},timestamp:0,activeDevicesID:[]};t.a={namespaced:!0,state:c,actions:i.a,mutations:s.a}},165:function(e,t,n){"use strict";function i(e,t){var n=this,i=e.state,s=e.commit,a=e.rootState;s("reqStart");var o={count:10,reverse:!0,filter:"position.latitude,position.longitude",to:i.timestamp||0};t.forEach(function(e){i.entities[e]||v.a.set(i.entities,e,[])});try{a.token&&t.forEach(function(){var e=u()(c.a.mark(function e(t){var i,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.connector.registry.getDevicesMessages(t,{data:r()(o)});case 2:i=e.sent,a=i.data,s("reqSuccessful",a);case 5:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}())}catch(e){s("reqFailed",e,{root:!0})}}var s=n(38),c=n.n(s),a=n(61),r=n.n(a),o=n(39),u=n.n(o),v=n(8);t.a={getHistoryByDeviceID:i}},166:function(e,t,n){"use strict";function i(e){}function s(e,t){var n=t.result;e.activeDevicesID.forEach(function(t){var i=n.filter(function(e){return e.device_id===t});if(!i.length)return e.entities[t]||d.a.set(e.entities,t,[]),!1;var s=e.entities[t]||[];d.a.set(e.entities,t,[].concat(l()(i),l()(s)).slice(0,10))}),d.a.set(e,"timestamp",parseInt(e.activeDevicesID.reduce(function(t,n){return e.entities[n].length&&e.entities[n][0].timestamp>t?e.entities[n][0].timestamp:t},0)))}function c(e){var t=this;e.activeDevicesID.length&&(e.activeDevicesID.forEach(function(){var e=f()(u.a.mark(function e(n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.connector.unsubscribeMessagesDevices(n);case 2:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()),d.a.set(e,"entities",{}),d.a.set(e,"activeDevicesID",[]),d.a.set(e,"timestamp",0))}function a(e,t){d.a.connector.unsubscribeMessagesDevices(t),d.a.delete(e.entities,t)}function r(e,t){var n=this;t.filter(function(t){return!e.activeDevicesID.includes(t)}).forEach(function(){var t=f()(u.a.mark(function t(i){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.connector.subscribeMessagesDevices(i,function(t){s(e,{result:[JSON.parse(t)]})});case 2:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}()),d.a.set(e,"activeDevicesID",t)}var o=n(38),u=n.n(o),v=n(39),f=n.n(v),p=n(167),l=n.n(p),d=n(8);t.a={reqStart:i,reqSuccessful:s,clear:c,clearByID:a,setActiveDevicesID:r}},264:function(e,t){},286:function(e,t){},287:function(e,t){},298:function(e,t){},300:function(e,t){},301:function(e,t,n){function i(e){n(302)}var s=n(114)(n(303),n(304),i,null,null);e.exports=s.exports},302:function(e,t){},303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},304:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},staticRenderFns:[]}}},[117]);